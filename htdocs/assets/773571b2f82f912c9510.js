"use strict";(this.webpackChunkdiscord_app=this.webpackChunkdiscord_app||[]).push([[68696],{304836:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0});t.changePaymentSource=function(e,t,r,n){return S.apply(this,arguments)};t.changeSubscriptionCurrency=function(e,t,r){return y.apply(this,arguments)};t.clearError=function(){a.default.dispatch({type:i.ActionTypes.PREMIUM_PAYMENT_ERROR_CLEAR})};t.resubscribe=function(e,t,r,n){return d.apply(this,arguments)};t.selectPlan=function(e){a.default.dispatch({type:i.ActionTypes.PREMIUM_PAYMENT_SELECT_PLAN,subscriptionPlanId:e})};t.subscribe=function(e,t,r,n,a){return f.apply(this,arguments)};var n=l(r(441143)),a=l(r(636602)),u=r(838583),o=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var r=c(t);if(r&&r.has(e))return r.get(e);var n={},a=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var u in e)if("default"!==u&&Object.prototype.hasOwnProperty.call(e,u)){
var o=a?Object.getOwnPropertyDescriptor(e,u):null;o&&(o.get||o.set)?Object.defineProperty(n,u,o):n[u]=e[u]}n.default=e;r&&r.set(e,n);return n}(r(832635)),i=r(770348);function c(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(c=function(e){return e?r:t})(e)}function l(e){return e&&e.__esModule?e:{default:e}}function s(e,t,r,n,a,u,o){try{var i=e[u](o),c=i.value}catch(e){r(e);return}i.done?t(c):Promise.resolve(c).then(n,a)}function p(e){return function(){var t=this,r=arguments;return new Promise((function(n,a){var u=e.apply(t,r);function o(e){s(u,n,a,o,i,"next",e)}function i(e){s(u,n,a,o,i,"throw",e)}o(void 0)}))}}function f(){return(f=p(regeneratorRuntime.mark((function e(t,r,n,u,c){var l;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a.default.dispatch({type:i.ActionTypes.PREMIUM_PAYMENT_SUBSCRIBE_START});e.prev=1;e.next=4;return o.createSubscription({items:[{planId:t,quantity:1}],paymentSource:n,trialId:u,code:c,
currency:r});case 4:null!=(l=e.sent).subscription&&a.default.dispatch({type:i.ActionTypes.PREMIUM_PAYMENT_SUBSCRIBE_SUCCESS,subscription:l.subscription});return e.abrupt("return",l);case 9:e.prev=9;e.t0=e.catch(1);a.default.dispatch({type:i.ActionTypes.PREMIUM_PAYMENT_SUBSCRIBE_FAIL,error:e.t0});throw e.t0;case 13:case"end":return e.stop()}}),e,null,[[1,9]])})))).apply(this,arguments)}function d(){return(d=p(regeneratorRuntime.mark((function e(t,r,c,l){var s,p;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.prev=0;s=(0,u.getPremiumPlanItem)(t);(0,n.default)(s,"Expected existing premium plan");p=(0,u.getItemsWithUpsertedPremiumPlanId)(t,s.planId);e.next=6;return o.updateSubscription(t,{status:i.SubscriptionStatusTypes.ACTIVE,paymentSource:c,items:p,currency:r},l);case 6:a.default.dispatch({type:i.ActionTypes.PREMIUM_PAYMENT_UPDATE_SUCCESS});e.next=13;break;case 9:e.prev=9;e.t0=e.catch(0);a.default.dispatch({
type:i.ActionTypes.PREMIUM_PAYMENT_UPDATE_FAIL,error:e.t0});throw e.t0;case 13:case"end":return e.stop()}}),e,null,[[0,9]])})))).apply(this,arguments)}function y(){return(y=p(regeneratorRuntime.mark((function e(t,r,n){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.prev=0;e.next=3;return o.changeSubscriptionCurrency(t,r,n);case 3:a.default.dispatch({type:i.ActionTypes.PREMIUM_PAYMENT_UPDATE_SUCCESS});e.next=10;break;case 6:e.prev=6;e.t0=e.catch(0);a.default.dispatch({type:i.ActionTypes.PREMIUM_PAYMENT_UPDATE_FAIL,error:e.t0});throw e.t0;case 10:case"end":return e.stop()}}),e,null,[[0,6]])})))).apply(this,arguments)}function S(){return(S=p(regeneratorRuntime.mark((function e(t,r,n,u){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.prev=0;e.next=3;return o.changePaymentSource(t,r,n,u);case 3:a.default.dispatch({type:i.ActionTypes.PREMIUM_PAYMENT_UPDATE_SUCCESS});e.next=10;break;case 6:e.prev=6;e.t0=e.catch(0)
;a.default.dispatch({type:i.ActionTypes.PREMIUM_PAYMENT_UPDATE_FAIL,error:e.t0});throw e.t0;case 10:case"end":return e.stop()}}),e,null,[[0,6]])})))).apply(this,arguments)}},723420:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0});t.clearPurchaseError=function(){o.default.dispatch({type:y.ActionTypes.SKU_PURCHASE_CLEAR_ERROR})};t.fetchPurchasePreview=function(e,t,r){return P.apply(this,arguments)};t.fetchSKU=function(e,t){return E.apply(this,arguments)};t.fetchSKUsForApplication=function(e,t){return h.apply(this,arguments)};t.grantChannelBranchEntitlement=function(e,t,r){return A.apply(this,arguments)};t.purchaseSKU=function(e,t,r){return T.apply(this,arguments)};t.showPurchaseConfirmationStep=function(){o.default.wait((function(){return o.default.dispatch({type:y.ActionTypes.SKU_PURCHASE_SHOW_CONFIRMATION_STEP})}))};t.updateSKUPaymentIsGift=function(e){o.default.dispatch({type:y.ActionTypes.SKU_PURCHASE_UPDATE_IS_GIFT,isGift:e})}
;var n=S(r(468811)),a=S(r(118915)),u=S(r(972247)),o=S(r(636602)),i=r(327269),c=S(r(225035)),l=S(r(399561)),s=S(r(424099)),p=r(71246),f=r(204785),d=r(832635),y=r(770348);function S(e){return e&&e.__esModule?e:{default:e}}function _(){_=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e};return _.apply(this,arguments)}function v(e,t,r,n,a,u,o){try{var i=e[u](o),c=i.value}catch(e){r(e);return}i.done?t(c):Promise.resolve(c).then(n,a)}function m(e){return function(){var t=this,r=arguments;return new Promise((function(n,a){var u=e.apply(t,r);function o(e){v(u,n,a,o,i,"next",e)}function i(e){v(u,n,a,o,i,"throw",e)}o(void 0)}))}}function E(){return(E=m(regeneratorRuntime.mark((function e(t,r){var n,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null==l.default.get(r)){e.next=2;break}return e.abrupt("return");case 2:o.default.dirtyDispatch({
type:y.ActionTypes.SKU_FETCH_START,skuId:r});e.prev=3;n=s.default.inTestModeForApplication(t);e.next=7;return(0,f.httpGetWithCountryCodeQuery)(n?y.Endpoints.STORE_SKU(r):y.Endpoints.STORE_PUBLISHED_LISTINGS_SKU(r));case 7:a=e.sent;o.default.dispatch({type:y.ActionTypes.SKU_FETCH_SUCCESS,sku:n?a.body:a.body.sku});e.next=15;break;case 11:e.prev=11;e.t0=e.catch(3);o.default.dispatch({type:y.ActionTypes.SKU_FETCH_FAIL,skuId:r});throw new c.default("Failed to fetch SKU "+r);case 15:case"end":return e.stop()}}),e,null,[[3,11]])})))).apply(this,arguments)}function h(){return(h=m(regeneratorRuntime.mark((function e(t,r){var n,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:void 0===r&&(r=!0);if(s.default.inTestModeForApplication(t)||!r){e.next=3;break}throw new Error("this should only be used in test mode");case 3:e.next=5;return(0,f.httpGetWithCountryCodeQuery)(y.Endpoints.APPLICATION_SKUS(t));case 5:n=e.sent;a=n.body;o.default.dispatch({
type:y.ActionTypes.SKUS_FETCH_SUCCESS,skus:a,applicationId:t});return e.abrupt("return",a);case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function P(){return(P=m(regeneratorRuntime.mark((function e(t,r,n){var a,u;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a={payment_source_id:n};s.default.inTestModeForApplication(t)&&(a.test_mode=!0);e.next=4;return(0,f.httpGetWithCountryCodeQuery)({url:y.Endpoints.STORE_SKU_PURCHASE(r),query:a,oldFormErrors:!0});case 4:u=e.sent;o.default.dispatch({type:y.ActionTypes.SKU_PURCHASE_PREVIEW_FETCH_SUCCESS,skuId:r,paymentSourceId:n,price:u.body});return e.abrupt("return",u);case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function A(){return(A=m(regeneratorRuntime.mark((function e(t,r,n){var u,c;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:o.default.dispatch({type:y.ActionTypes.SKU_PURCHASE_START,applicationId:t,skuId:n});e.prev=1;e.next=4
;return a.default.post({url:y.Endpoints.CHANNEL_ENTITLEMENT_GRANT(r),oldFormErrors:!0});case 4:u=e.sent;o.default.dispatch({type:y.ActionTypes.SKU_PURCHASE_SUCCESS,skuId:n,entitlements:u.body,libraryApplications:[]});return e.abrupt("return",u.body);case 9:e.prev=9;e.t0=e.catch(1);c=new i.BillingError(e.t0);o.default.dispatch({type:y.ActionTypes.SKU_PURCHASE_FAIL,applicationId:t,skuId:n,error:c});throw c;case 14:case"end":return e.stop()}}),e,null,[[1,9]])})))).apply(this,arguments)}var I={isGift:!1};function b(){var e=u.default.get(y.PURCHASE_TOKEN);if(null!=e&&e.expires>=Date.now())return e.purchaseToken;var t=n.default.v4();u.default.set(y.PURCHASE_TOKEN,{purchaseToken:t,expires:Date.now()+y.PURCHASE_TOKEN_TTL});return t}function T(){return(T=m(regeneratorRuntime.mark((function e(t,r,n){var u,c,l,f,S,v,m,E,h,P,A;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:u=_({},I,{},n),c=u.paymentSource,l=u.expectedAmount,f=u.expectedCurrency,S=u.analyticsLoadId,
v=u.isGift,m=u.giftStyle,E=u.subscriptionPlanId;o.default.wait((function(){o.default.dispatch({type:y.ActionTypes.SKU_PURCHASE_START,applicationId:t,skuId:r})}));e.prev=2;h={gift:v,sku_subscription_plan_id:E};if(!s.default.inTestModeForApplication(t)){e.next=8;break}h.test_mode=!0;e.next=17;break;case 8:if(null==c){e.next=13;break}h.payment_source_id=c.id;e.next=12;return(0,d.createPaymentSourceToken)(c);case 12:h.payment_source_token=e.sent;case 13:null!=l&&(h.expected_amount=l);null!=f&&(h.expected_currency=f);null!=m&&(h.gift_style=m);h.purchase_token=b();case 17:e.next=19;return a.default.post({url:y.Endpoints.STORE_SKU_PURCHASE(r),body:h,context:{load_id:S},oldFormErrors:!0});case 19:P=e.sent;o.default.dispatch({type:y.ActionTypes.SKU_PURCHASE_SUCCESS,skuId:r,libraryApplications:null!=P.body.library_applications?P.body.library_applications.filter(p.isNotNullish):[],entitlements:P.body.entitlements,giftCode:P.body.gift_code});return e.abrupt("return",P.body);case 24:e.prev=24
;e.t0=e.catch(2);A=e.t0 instanceof i.BillingError?e.t0:new i.BillingError(e.t0);o.default.dispatch({type:y.ActionTypes.SKU_PURCHASE_FAIL,applicationId:t,skuId:r,error:A});throw A;case 29:case"end":return e.stop()}}),e,null,[[2,24]])})))).apply(this,arguments)}},779111:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0});t.default=function(e){var t,r=e.selectedPaymentSourceId,n=e.paymentSources,S=e.prependOption,_=e.hidePersonalInformation,v=e.onChange,b=e.onPaymentSourceAdd,T=e.warning,R=e.disabled,O=void 0!==R&&R,g=e.className,w=e.optionClassName,M=e.dropdownLoading,N=[].concat(null!=S?[S]:[],(C=n,function(e){if(Array.isArray(e))return h(e)}(C)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(C)||E(C)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),[I]).map((function(e,t){
if(e instanceof o.default){var r,n=function(e,t){if(e instanceof o.CreditCardSourceRecord)return e.id===I.id?{brand:null,label:d.default.Messages.PAYMENT_SOURCES_ADD}:{brand:t?c.default.Types.UNKNOWN:e.brand,label:d.default.Messages.PAYMENT_SOURCE_CARD_ENDING_IN.format({last4:t?A:e.last4})};if(e instanceof o.PaypalSourceRecord)return{brand:c.default.Types.PAYPAL,label:t?P:e.email};if(e instanceof o.SofortSourceRecord)return{brand:c.default.Types.SOFORT,label:t?P:e.email};if(e instanceof o.GiropaySourceRecord)return{brand:c.default.Types.GIROPAY,label:d.default.Messages.PAYMENT_SOURCE_GIROPAY};if(e instanceof o.Przelewy24SourceRecord)return{brand:c.default.Types.PRZELEWY24,label:t?P:e.email};if(e instanceof o.PaysafeSourceRecord)return{brand:c.default.Types.PAYSAFECARD,label:d.default.Messages.PAYMENT_SOURCE_PAYSAFE_CARD};throw new Error("Invalid Payment Source")}(e,_),a=n.brand,l=n.label;return{value:e.id,label:m(i.default,{className:y.default.paymentSourceSelectedOption,
align:i.default.Align.CENTER},void 0,null!=a?m(c.default,{type:c.default.getType(a)}):null,m("div",{className:(0,u.default)(y.default.paymentSourceLabel,(r={},r[y.default.error]=e.invalid,r))},void 0,l))}}return{key:t,value:e.value,label:m(i.default,{align:i.default.Align.CENTER},void 0,m("div",{className:y.default.paymentSourceLabel},void 0,e.label))}}));var C;return a.createElement(a.Fragment,null,m(p.SingleSelect,{options:N,value:r,onChange:function(e){if(e===I.id)null!=b&&b();else{var t=n.find((function(t){return t.id===e}));null!=v&&v(t)}},isDisabled:O,className:(0,u.default)((t={},t[y.default.paymentSourceHasWarning]=null!=T,t),g),optionClassName:w,placeholder:d.default.Messages.PAYMENT_SOURCE_TYPE_SELECT,renderOptionValue:function(e){var t=function(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==r)return;var n,a,u=[],o=!0,i=!1;try{
for(r=r.call(e);!(o=(n=r.next()).done);o=!0){u.push(n.value);if(t&&u.length===t)break}}catch(e){i=!0;a=e}finally{try{o||null==r.return||r.return()}finally{if(i)throw a}}return u}(e,t)||E(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}(e,1),r=t[0];return M?m(l.default,{type:l.SpinnerTypes.SPINNING_CIRCLE}):r.label}}),null!=T?m("div",{className:y.default.paymentSourceWarning},void 0,m(s.default,{className:y.default.paymentSourceWarningIcon,color:f.Colors.STATUS_YELLOW}),T):null)};var n,a=v(r(667294)),u=S(r(294184)),o=v(r(713293)),i=S(r(530250)),c=S(r(708100)),l=v(r(80828)),s=S(r(417184)),p=r(967965),f=r(770348),d=S(r(247001)),y=S(r(884947));function S(e){return e&&e.__esModule?e:{default:e}}function _(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(_=function(e){return e?r:t})(e)}function v(e,t){
if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var r=_(t);if(r&&r.has(e))return r.get(e);var n={},a=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var u in e)if("default"!==u&&Object.prototype.hasOwnProperty.call(e,u)){var o=a?Object.getOwnPropertyDescriptor(e,u):null;o&&(o.get||o.set)?Object.defineProperty(n,u,o):n[u]=e[u]}n.default=e;r&&r.set(e,n);return n}function m(e,t,r,a){n||(n="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var u=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=a;else if(o>1){for(var i=new Array(o),c=0;c<o;c++)i[c]=arguments[c+3];t.children=i}if(t&&u)for(var l in u)void 0===t[l]&&(t[l]=u[l]);else t||(t=u||{});return{$$typeof:n,type:e,key:void 0===r?null:""+r,ref:null,props:t,_owner:null}}function E(e,t){if(e){if("string"==typeof e)return h(e,t);var r=Object.prototype.toString.call(e).slice(8,-1)
;"Object"===r&&e.constructor&&(r=e.constructor.name);return"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?h(e,t):void 0}}function h(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var P="***@***.***",A="****",I=new o.CreditCardSourceRecord({id:"new_payment_source_id",brand:c.default.Types.UNKNOWN,type:f.PaymentSourceTypes.CARD})},551081:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0});t.default=function(e,t){var r=(s=(0,n.useState)(e),p=2,function(e){if(Array.isArray(e))return e}(s)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,a,u=[],o=!0,i=!1;try{for(r=r.call(e);!(o=(n=r.next()).done);o=!0){u.push(n.value);if(t&&u.length===t)break}}catch(e){i=!0;a=e}finally{try{o||null==r.return||r.return()}finally{if(i)throw a}}return u}}(s,p)||function(e,t){if(e){if("string"==typeof e)return o(e,t)
;var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);return"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?o(e,t):void 0}}(s,p)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),i=r[0],c=r[1],l=(0,a.useLazyValue)((function(){return new u.Timeout}));var s,p;(0,n.useEffect)((function(){return function(){return l.stop()}}),[l]);var f=(0,n.useCallback)((function(r){c(r);r!==e&&l.start(t,(function(){return c(e)}))}),[t,e,l]);return[i,f]};var n=r(667294),a=r(143544),u=r(91817);function o(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}},54975:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0});t.Step=t.COLLAPSED_PAYMENT_BREADCRUMB_STEPS=void 0;t.errorToStep=function(e){if(null!=e){
if(e.hasCardError())return a.CREDIT_CARD_INFORMATION;if(e.hasAddressError())return a.ADDRESS}return null};t.getLabelForStep=function(e){switch(e){case a.PLAN_SELECT:return i.default.Messages.BILLING_STEP_SELECT_PLAN;case a.PAYMENT_TYPE:return i.default.Messages.BILLING_STEP_PAYMENT;case a.REVIEW:return i.default.Messages.BILLING_STEP_REVIEW;case a.SHOP:return i.default.Messages.BILLING_STEP_SHOP}throw new Error("Unexpected step: "+e)};t.usePurchaseStateForStep=function(e,t,r){u.useEffect((function(){null!=e&&e!==a.REVIEW&&t!==o.PurchaseState.WAITING&&t!==o.PurchaseState.COMPLETED&&r(o.PurchaseState.WAITING)}),[e,t,r])};var n,a,u=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var r=c(t);if(r&&r.has(e))return r.get(e);var n={},a=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var u in e)if("default"!==u&&Object.prototype.hasOwnProperty.call(e,u)){var o=a?Object.getOwnPropertyDescriptor(e,u):null
;o&&(o.get||o.set)?Object.defineProperty(n,u,o):n[u]=e[u]}n.default=e;r&&r.set(e,n);return n}(r(667294)),o=r(842535),i=(n=r(247001))&&n.__esModule?n:{default:n};function c(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(c=function(e){return e?r:t})(e)}t.Step=a;!function(e){e.PAYMENT_TYPE="payment_type";e.CREDIT_CARD_INFORMATION="credit_card_information";e.PAYPAL_INFORMATION="paypal_information";e.SOFORT_INFORMATION="sofort_information";e.PRZELEWY24_INFORMATION="przelewy24_information";e.PAYMENT_REQUEST_INFORMATION="payment_request_information";e.ADDRESS="address";e.AWAITING_AUTHENTICATION="awaiting_authentication";e.SKU_SELECT="sku_select";e.PLAN_SELECT="plan_select";e.PREMIUM_UPSELL="premium_upsell";e.PREMIUM_GUILD_UPSELL="premium_guild_upsell";e.REVIEW="review";e.CONFIRM="confirm";e.CLAIM_FREE_SKU="claim_free_sku";e.SKU_PREVIEW="sku_preview";e.LOADING_PAYMENT_SOURCES="loading_payment_sources";e.SHOP="shop";e.PROMOTION_INFO="promotion_info"
}(a||(t.Step=a={}));var l=new Set([a.CREDIT_CARD_INFORMATION,a.PAYMENT_REQUEST_INFORMATION,a.PAYPAL_INFORMATION,a.ADDRESS,a.CLAIM_FREE_SKU,a.SKU_PREVIEW,a.PREMIUM_UPSELL,a.SOFORT_INFORMATION,a.PRZELEWY24_INFORMATION]);t.COLLAPSED_PAYMENT_BREADCRUMB_STEPS=l},511217:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0});t.createSubscriptionInvoicePreview=P;t.getItemUnitPriceWithDiscount=function(e){var t=e.subscriptionPlanPrice;e.discounts.forEach((function(r){var n=r.amount/e.quantity;t-=n}));return t};t.updateSubscriptionInvoicePreview=I;t.useSubscriptionInvoicePreview=function(e){if("subscriptionId"in e&&null==e.subscriptionId){var t=e,r=(t.subscriptionId,_(t,p));e=r}var u=(0,n.useCallback)((function(){return"subscriptionId"in e?I(e):"items"in e?P(e):null}),[JSON.stringify(e)]);return function(e,t){var r=e.preventFetch,u=void 0!==r&&r,i=v((0,n.useState)(null),2),l=i[0],s=i[1],p=v((0,n.useState)(null),2),f=p[0],d=p[1],y=(0,a.useStateFromStores)([c.default],(function(){
return c.default.getSubscriptions()}));(0,n.useEffect)((function(){var e=!1;function r(){return n.apply(this,arguments)}function n(){return(n=h(regeneratorRuntime.mark((function r(){var n;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:r.prev=0;s(null);r.next=4;return t();case 4:n=r.sent;e||s(n);r.next=11;break;case 8:r.prev=8;r.t0=r.catch(0);e||d(new o.BillingError(r.t0));case 11:case"end":return r.stop()}}),r,null,[[0,8]])})))).apply(this,arguments)}u||r();return function(){e=!0}}),[u,t,y]);return[l,f]}(e,u)};var n=r(667294),a=r(536211),u=y(r(118915)),o=r(327269),i=y(r(412652)),c=y(r(146771)),l=r(838583),s=r(770348),p=["subscriptionId"],f=["planId"],d=["planId"];function y(e){return e&&e.__esModule?e:{default:e}}function S(){S=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e};return S.apply(this,arguments)}function _(e,t){if(null==e)return{}
;var r,n,a={},u=Object.keys(e);for(n=0;n<u.length;n++){r=u[n];t.indexOf(r)>=0||(a[r]=e[r])}return a}function v(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==r)return;var n,a,u=[],o=!0,i=!1;try{for(r=r.call(e);!(o=(n=r.next()).done);o=!0){u.push(n.value);if(t&&u.length===t)break}}catch(e){i=!0;a=e}finally{try{o||null==r.return||r.return()}finally{if(i)throw a}}return u}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return m(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return m(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function m(e,t){
(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function E(e,t,r,n,a,u,o){try{var i=e[u](o),c=i.value}catch(e){r(e);return}i.done?t(c):Promise.resolve(c).then(n,a)}function h(e){return function(){var t=this,r=arguments;return new Promise((function(n,a){var u=e.apply(t,r);function o(e){E(u,n,a,o,i,"next",e)}function i(e){E(u,n,a,o,i,"throw",e)}o(void 0)}))}}function P(e){return A.apply(this,arguments)}function A(){return(A=h(regeneratorRuntime.mark((function e(t){var r,n,a,o,c,p,d,y,v;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=t.items,n=t.paymentSourceId,a=t.trialId,o=t.code,c=t.applyEntitlements,p=void 0!==c&&c,d=t.currency;r=(0,l.coerceExistingItemsToNewItemInterval)(r);y={items:r.map((function(e){var t=e.planId;return S({},_(e,f),{plan_id:t})})),payment_source_id:n,trial_id:a,code:o,apply_entitlements:p,currency:d};e.next=5;return u.default.post({url:s.Endpoints.BILLING_SUBSCRIPTIONS_PREVIEW,body:y,
oldFormErrors:!0});case 5:v=e.sent;return e.abrupt("return",i.default.createInvoiceFromServer(v.body));case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function I(e){return b.apply(this,arguments)}function b(){return(b=h(regeneratorRuntime.mark((function e(t){var r,n,a,o,c,p,f,y,v,m;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=t.subscriptionId,a=t.items,o=t.paymentSourceId,c=t.renewal,p=t.currency,f=t.applyEntitlements,y=void 0!==f&&f;null!=a&&(a=(0,l.coerceExistingItemsToNewItemInterval)(a));v={items:null===(r=a)||void 0===r?void 0:r.map((function(e){var t=e.planId;return S({},_(e,d),{plan_id:t})})),payment_source_id:o,renewal:c,apply_entitlements:y,currency:p};e.next=5;return u.default.patch({url:s.Endpoints.BILLING_SUBSCRIPTION_PREVIEW(n),body:v,oldFormErrors:!0});case 5:m=e.sent;return e.abrupt("return",i.default.createInvoiceFromServer(m.body));case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}},842535:(e,t)=>{
Object.defineProperty(t,"__esModule",{value:!0});t.PurchaseState=void 0;var r;t.PurchaseState=r;!function(e){e.WAITING="WAITING";e.PURCHASING="PURCHASING";e.FAIL="FAIL";e.COMPLETED="COMPLETED"}(r||(t.PurchaseState=r={}))},708100:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0});t.default=t.IconTypes=void 0;var n,a=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var r=c(t);if(r&&r.has(e))return r.get(e);var n={},a=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var u in e)if("default"!==u&&Object.prototype.hasOwnProperty.call(e,u)){var o=a?Object.getOwnPropertyDescriptor(e,u):null;o&&(o.get||o.set)?Object.defineProperty(n,u,o):n[u]=e[u]}n.default=e;r&&r.set(e,n);return n}(r(667294)),u=i(r(294184)),o=i(r(454430));function i(e){return e&&e.__esModule?e:{default:e}}function c(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(c=function(e){return e?r:t})(e)}
function l(e,t,r,a){n||(n="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var u=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=a;else if(o>1){for(var i=new Array(o),c=0;c<o;c++)i[c]=arguments[c+3];t.children=i}if(t&&u)for(var l in u)void 0===t[l]&&(t[l]=u[l]);else t||(t=u||{});return{$$typeof:n,type:e,key:void 0===r?null:""+r,ref:null,props:t,_owner:null}}function s(e,t){s=Object.setPrototypeOf||function(e,t){e.__proto__=t;return e};return s(e,t)}var p=Object.freeze({UNKNOWN:"unknown",VISA:"visa",DISCOVER:"discover",MASTERCARD:"mastercard",AMEX:"amex",PAYPAL:"paypal",PAYMENT_REQUEST:"paymentRequest",G_PAY:"gPay",DINERS:"diners",JCB:"jcb",UNIONPAY:"unionpay",SOFORT:"sofort",PRZELEWY24:"przelewy24",GIROPAY:"giropay",PAYSAFECARD:"paysafecard"});t.IconTypes=p;var f={SMALL:o.default.cardIconSmall,MEDIUM:o.default.cardIconMedium,LARGE:o.default.cardIconLarge,XLARGE:o.default.cardIconXLarge},d=function(e){!function(e,t){
e.prototype=Object.create(t.prototype);e.prototype.constructor=e;s(e,t)}(t,e);function t(){return e.apply(this,arguments)||this}t.getType=function(e){if(null==e)return p.UNKNOWN;var t=e.replace(/[^a-z0-9]/gi,"").toUpperCase();return p[t]||p.UNKNOWN};t.prototype.render=function(){var e,t=this.props,r=t.flipped,n=t.type,a=t.className,i=t.size;return l("div",{className:(0,u.default)(i,o.default[n],a,(e={},e[o.default.flipped]=r,e))},void 0,n)};return t}(a.PureComponent);d.displayName="PaymentSourceIcon";d.Types=p;d.Sizes=f;d.defaultProps={size:f.SMALL,flipped:!1};var y=d;t.default=y},298104:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0});t.fetchSubscriptionPlansOnNewPaymentSource=v;t.getCurrencies=m;t.planHasCurrency=function(e,t,r){var n=c.default.get(e);(0,a.default)(null!=n,"plan is undefined");return m(n,r,!1).includes(t)};t.useCurrencyWithPaymentSourceChange=function(e,t,r,a,u){var o=(f=n.useReducer((function(e,t){return d({},e,{},t)}),null!=r?{paymentSourceId:r,currency:e
}:{currency:e}),S=2,function(e){if(Array.isArray(e))return e}(f)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,a,u=[],o=!0,i=!1;try{for(r=r.call(e);!(o=(n=r.next()).done);o=!0){u.push(n.value);if(t&&u.length===t)break}}catch(e){i=!0;a=e}finally{try{o||null==r.return||r.return()}finally{if(i)throw a}}return u}}(f,S)||function(e,t){if(e){if("string"==typeof e)return y(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);return"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?y(e,t):void 0}}(f,S)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),l=o[0],s=o[1],p=(0,i.useSubscriptionPlansLoaded)(u);var f,S;n.useEffect((function(){var e=function(){
var e=_(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.next=2;return v(r,u);case 2:n=[];null!=t&&null!=c.default.get(t)&&(n=m(t,r,a));n.length>0?s({paymentSourceId:r,currency:n[0]}):s({paymentSourceId:r});case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();e()}),[r,JSON.stringify(u),t,a,p]);var E=l.paymentSourceId!==r||null==t||!p;return{priceOptions:l,setCurrency:function(e){s({currency:e})},currencyLoading:E}};var n=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var r=f(t);if(r&&r.has(e))return r.get(e);var n={},a=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var u in e)if("default"!==u&&Object.prototype.hasOwnProperty.call(e,u)){var o=a?Object.getOwnPropertyDescriptor(e,u):null;o&&(o.get||o.set)?Object.defineProperty(n,u,o):n[u]=e[u]}n.default=e;r&&r.set(e,n);return n
}(r(667294)),a=p(r(441143)),u=p(r(636602)),o=r(856259),i=r(158384),c=p(r(909584)),l=r(838583),s=r(770348);function p(e){return e&&e.__esModule?e:{default:e}}function f(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(f=function(e){return e?r:t})(e)}function d(){d=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e};return d.apply(this,arguments)}function y(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function S(e,t,r,n,a,u,o){try{var i=e[u](o),c=i.value}catch(e){r(e);return}i.done?t(c):Promise.resolve(c).then(n,a)}function _(e){return function(){var t=this,r=arguments;return new Promise((function(n,a){var u=e.apply(t,r);function o(e){S(u,n,a,o,i,"next",e)}function i(e){S(u,n,a,o,i,"throw",e)}o(void 0)}))}}function v(e,t){void 0===t&&(t=Object.values(s.PremiumSubscriptionSKUs))
;return null==e||c.default.hasPaymentSourceForSKUIds(e,t)?Promise.resolve():new Promise((function(e){u.default.wait(_(regeneratorRuntime.mark((function r(){return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:r.next=2;return(0,o.fetchSubscriptionPlansBySKUs)(t);case 2:e();case 3:case"end":return r.stop()}}),r)}))))}))}function m(e,t,r){var n=[],u={purchaseType:r?s.PriceSetAssignmentPurchaseTypes.GIFT:s.PriceSetAssignmentPurchaseTypes.DEFAULT},o="string"==typeof e?e:e.id;if((0,l.inPriceDeterminationExperiment)()){var i=c.default.get(o);(0,a.default)(i,"subscription plan not loaded");null!=t&&c.default.hasPaymentSourceForSKUId(t,i.skuId)&&(u.paymentSourceId=t);if((n=(0,l.experimentalGetPrices)(o,u).map((function(e){return e.currency}))).length<1)throw Error("No currencies returned for plan "+o+" and paymentSource "+t)}else n.push((0,l.getPrice)(o,!1,r,{paymentSourceId:t}).currency);return n}}}]);
//# sourceMappingURL=773571b2f82f912c9510.js.map